services:
  api:
    build:
      context: ./apps/api
    environment:
      - PORT=5000
      - MEILI_HOST=http://meilisearch:7700
      - MEILI_MASTER_KEY=masterKey123
      # Add other env vars if needed
    ports:
      - "5000:5000"
    volumes:
      - ./apps/api/data:/app/data
      - ./apps/api/uploads:/app/uploads
    depends_on:
      - meilisearch

  web:
    build:
      context: ./apps/web
    environment:
      - VITE_API_URL=/api
    depends_on:
      - api
    ports:
      - "8080:80"

  meilisearch:
    image: getmeili/meilisearch:v1.10
    environment:
      - MEILI_MASTER_KEY=masterKey123
      - MEILI_NO_ANALYTICS=true
    ports:
      - "7700:7700"
    volumes:
      - meili_data:/meili_data

volumes:
  api_data:
  api_uploads:
  meili_data:
